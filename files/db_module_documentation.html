
<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>Using someone else's code | Introduction to Python | HT17 @ NBIS</title>

        <meta name="description" content="Python Course given by NBIS in HT17">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="https://nbisweden.github.io/PythonCourse/img/apple-touch-icon.png">
	<link rel="shortcut icon" href="https://nbisweden.github.io/PythonCourse/img/favicon.ico" />

        <link rel="stylesheet" href="https://nbisweden.github.io/PythonCourse/css/normalize.css">
        <link rel="stylesheet" href="https://nbisweden.github.io/PythonCourse/css/ht17.css">
	<link rel="stylesheet" href="https://nbisweden.github.io/PythonCourse/css/font-awesome-4.7.0/css/font-awesome.min.css">

	<link rel="stylesheet" href="https://nbisweden.github.io/PythonCourse/css/pygments/style.css">

        <script src="https://nbisweden.github.io/PythonCourse/js/modernizr-2.8.3.min.js"></script>
	<!-- html5 shim and respond.js ie8 support of html5 elements and media queries -->
	<!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->
    </head>
    <body style="margin:20px;width:80%">
        <!--[if lt IE 9]>
            <p class="browserupgrade">
	      You are using an <strong>outdated</strong> browser.
	      Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.
	    </p>
        <![endif]-->


<h1 class="collapse-trigger" id="house-database">House Database</h1>

<p>
<span>Written by Frédéric Haziza</a></span>
</p>


<h1 id="db-documentation" class="collapse-trigger">Module documentation</h1>

<p>The code to produce would typically start by importing the necessary
functions and classes from the <code class="highlighter-rouge">db</code> module.</p>

<div class="language-python highlighter-rouge"><pre class="codehilite"><code><span class="kn">from</span> <span class="nn">db</span> <span class="kn">import</span> <span class="n">HomeDB</span>

<span class="c"># Initilizing the database</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">HomeDB</span><span class="p">(</span><span class="s">'uppsala.sqlite'</span><span class="p">)</span>
<span class="n">database</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">'rooms &gt; 1 and rooms &lt; 3 and area &gt; 58 and rent &lt; 3000'</span><span class="p">)</span>
<span class="n">database</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c"># Looping now through the selection</span>
<span class="k">for</span> <span class="n">home</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
	<span class="c"># Do something</span>

<span class="c"># Then plot</span>
</code></pre>
</div>

<p>The above code essentially initializes the database, fetches some
selection, based on some criteria, and plots the result on a map. Yes,
it’s visual, it’ fun.</p>

<p>You could
use the template file <code>db.py</code>, that
you have to complete.</p>

<hr class="force" />

<p>You can of course look at the documentation from the sourcecode
itself, using the <code class="highlighter-rouge">help</code> function.</p>

<div class="highlighter-rouge"><pre class="codehilite"><code>$ python
&gt;&gt;&gt; import db
&gt;&gt;&gt; help(db.plot)
</code></pre>
</div>

<p>The plot function has a few keyword parameters.</p>

<div class="highlighter-rouge"><pre class="codehilite"><code>plot(selection,
     output='selection.html',
     special=None,
     zoom=12,
     latitude=59.83732598851705,
     longitude=17.64549846959149,
     radius=5000)
	

    Outputs the selection to map file. Section is a list of HomeEntry.
    The center is given by latitude and longitude and marked on the map with a blue marker.
    The map draws a radius around the center.
    When the special is used, an extra green marker is ploted in the map.
</code></pre>
</div>

<p>For each home, it is possible to call the following functions:</p>

<dl>
<dt><code>home</code>.get_location()</dt>
<dd>returns a pair (latitude,longitude) as a float tuple.</dd>

<dt><code>home</code>.get_price()</dt>
<dd>returns the price that home was sold for, in sek.</dd>

<dt><code>home</code>.get_area()</dt>
<dd>returns its surface in m<sup>2</sup>.</dd>

<p>For a list of homes, it is possible to sort it by price using the function below.</p>

<dl>
  <dt><code>sort_by_price(homes, reverse=False)</code></dt>
<dd>returns the sorted list, starting from the cheapest home. If <code>reverse</code>
is set to true, the list is instead sorted from expensive to cheap</dd>
</dl>


<hr class="force" />

<p>The
<a href="https://en.wikipedia.org/wiki/Haversine_formula">haversine formula</a>
determines the great-circle distance between two points on a sphere
given their longitudes and latitudes. This will be useful for
filtering the selection using the radius.</p>

<div class="highlighter-rouge"><pre class="codehilite"><code>$ python
&gt;&gt;&gt; import db
&gt;&gt;&gt; help(db.haversine)

Help on function haversine in module db:

haversine(lat1, lon1, lat2, lon2)
    Calculate the great circle distance (in m) between two points
    on the earth (specified in decimal degrees)
</code></pre>
</div>

	</main>

        
	<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
        <script>window.jQuery || document.write('<script src="https://nbisweden.github.io/PythonCourse/js/jquery-1.12.0.min.js"><\/script>')</script>
        <script src="https://nbisweden.github.io/PythonCourse/js/ht17.js"></script>

	


    </body>
</html>

